#!/bin/bash
# geoloc-theme-current: Show current active theme
# Usage: geoloc-theme-current

set -euo pipefail

BLUE='\033[0;34m'
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

# Find the dotfiles directory
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
DOTFILES_DIR="$(dirname "$(dirname "$SCRIPT_DIR")")/dotfiles"
THEMES_DIR="$DOTFILES_DIR/themes"

if [[ ! -d "$THEMES_DIR" ]]; then
  echo -e "${RED}Error: Themes directory not found: $THEMES_DIR${NC}" >&2
  exit 1
fi

current_theme=$(readlink "$THEMES_DIR/current" 2>/dev/null | sed 's|.*/||' || echo "")

if [[ -n "$current_theme" ]]; then
  echo -e "${GREEN}Current theme: $current_theme${NC}"
  
  if [[ -d "$THEMES_DIR/$current_theme" ]]; then
    echo -e "${BLUE}Theme files:${NC}"
    find "$THEMES_DIR/$current_theme" -type f | sed 's|.*/themes/[^/]*/|  |' | sort
  fi
else
  echo -e "${RED}No theme currently selected${NC}"
  echo -e "${BLUE}Available themes:${NC}"
  find "$THEMES_DIR" -maxdepth 1 -type d -not -name themes | sort | sed 's|.*/|  |'
fi